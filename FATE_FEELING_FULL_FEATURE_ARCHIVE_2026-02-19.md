# Fate & Feeling 전체 기능 상세 기록서 (리빌드 기준)

작성일: 2026-02-19  
기준 브랜치: `main`  
최근 핵심 커밋: `bf0a26e`, `47ba585`, `c92b72e`, `d68be6a`, `9c5af8f`, `17ade2a`

---

## 0) 이 문서 목적

이 문서는 "기존 코드를 뜯어고치기보다 새로 재구축"할 때, 지금까지 만든 기능을 빠짐없이 인수인계하기 위한 **기능 자산 아카이브**다.

- 유지할 것 / 버릴 것 / 재설계할 것을 빠르게 분리하기 위함
- 새 프로젝트(리빌드)에서 기능 누락을 방지하기 위함
- 기획/디자인/개발/QA가 같은 기준으로 리뷰하기 위함

---

## 1) 제품 정체성 및 운영 원칙

### 1-1. 제품 정체성
- 서비스명: **Fate & Feeling**
- 핵심 방향:
  1. 감성형 경험(브랜딩/스토리텔링)
  2. 근거형 분석(원국/만세력 기반)
  3. 모바일 퍼스트 UX

### 1-2. 최근 전략
- 전문가 리포트(기존 다크 톤) + 웹툰 뷰(스토리 컷) **듀얼 모드**
- 홈 진입부터 모드 선택형 게이트로 전환
- 입력 피로도 완화(초기 긴 폼 숨김, 단계형 유도)

### 1-3. 운영/개발 원칙
- 수정 후 `public ↔ fate-feeling/public` 동기화 필수
- 모바일 화면 기준(약 390~430폭) 우선 검증
- 결과 텍스트/점수/레이블 불일치 금지

---

## 2) 현재 페이지/기능 맵 (전체 웹)

`public/` 기준 주요 페이지:

- `index.html` : 메인 진입/온보딩/입력
- `test.html` : 설문형 테스트 플로우
- `result.html` : 결과 리포트 (전문가/웹툰 듀얼뷰)
- `total-fortune.html` : 전체 총운 입력/리포트
- `fortune-report.html`, `fortune-reports.html` : 총운 리포트 단건/목록
- `ai.html` : AI 상담
- `mode-overlap.html` : 관점 겹쳐보기(사주/타로/자미두수)
- `ziwei.html`, `ziwei-validate.html` : 자미두수 리딩/검증센터
- `saju.html`, `tarot.html`, `astro.html`, `mbti.html` : 모드별 개별 진입 페이지
- `today-secret.html` : 오늘의 비밀 점수
- `experts.html`, `community.html`, `philosophy.html`, `invest-sector.html` : 부가 페이지

---

## 3) 핵심 사용자 플로우 상세

## 3-1. 홈 진입 (`index.html`)

### A. 듀얼 엔트리 게이트
- 버튼 2개:
  - `웹툰으로 시작하기`
  - `정통 리포트로 시작하기`
- 전역 모드 상태 저장:
  - `ff-experience-mode = webtoon | report`

### B. 초기 긴 입력폼 노출 억제
- 첫 진입 시 입력 섹션 숨김
- 모드 선택 후 입력 서피스 활성화

### C. 온보딩 모달
- 고민 카테고리 선택(일반/19세 버전 분리)
- 분석 관점 선택(사주/타로/자미두수/점성술/인도/일본)
- "오늘 다시 보지 않기" 제공

### D. 오늘 다시 보지 않기 (모바일 버그 수정 완료)
- 최신 키: `ff-hide-onboarding-date` (Asia/Seoul 날짜)
- 오늘 날짜면 온보딩 모달 재노출 방지
- 자정 이후(다음날) 자동 재노출 가능 구조

---

## 3-2. 입력 서피스

### A. 웹툰 모드 입력
- 단계형 흐름(한 번에 1질문 중심)
- 이전/다음/결과보기 제어
- 현재 구현 단계:
  - 이름
  - 생년월일
  - 출생시간
  - 성별
  - 출생지
  - 고민 선택
  - 분석 관점 선택

### B. 정통 리포트 입력
- 컴팩트 폼 기반 진입
- 빠른 입력 + 빠른 결과 목표

### C. 성인 게이트
- 19금 카테고리(속궁합/키스궁합) 진입 전 인증
- 키: `ff-adult-verified`

### D. 연애 상태 분기
- 애정운 등 일부 고민은 연애상태 수집
- 키: `ff-love-state`

---

## 3-3. 테스트 (`test.html`)

- 설문 기반 플로우
- 카테고리/모드에 맞는 문항 로직
- 점수 가중치 계산을 통해 최종 결과 데이터 생성
- 결과 객체 저장 후 `result.html` 이동

(참고: 사주 관점은 무설문 직행 처리도 존재)

---

## 3-4. 결과 (`result.html`) — 가장 중요한 영역

### A. 듀얼 뷰
- 상단 스위치:
  - `전문가 리포트`
  - `웹툰으로 보기`
- 홈에서 고른 뷰 모드와 연동
  - `ff-result-view-mode`

### B. 전문가 리포트 뷰
- 카드형 데이터 리포트
- 점수/등급/지표/타임라인/요약/행동가이드
- 공유/상담 CTA 연결

### C. 웹툰 뷰 (1차)
- 챕터/컷 구조
- 말풍선/컷 애니메이션
- 웹툰형 타임라인/게이지
- 원국 섹션 웹툰화(챕터형 강조)

### D. 원국/만세력 강화
- 원국 8자 표시와 해석 강화
- 대운 흐름/시점 해석 보강
- 일주 강조 포인트 유지

---

## 3-5. 전체총운 (`total-fortune.html` + report pages)

- 전체총운 입력과 리포트 열람 분리
- 리포트 목록/단건 관리
- 최근 리포트 활성 선택
- 연도/시점 관점에서 요약 제공

관련 키:
- `ff-total-fortune-reports`
- `ff-total-fortune-active-report-id`

---

## 3-6. AI 상담 (`ai.html`)

- 상담 결과/입력 분리 개선 이력
- 상담 우선 응답 플로우
- 솔루션 모드 옵션
- UI 튜닝 및 레이아웃 정리 반영

---

## 3-7. 관점 확장/검증 도구

### 관점 확장
- 인도관점 / 일본관점 추가
- 모드별 스냅샷/겹쳐보기 페이지 제공

### 검증
- 자미두수 검증센터(`ziwei-validate.html`) 구축
- 케이스 기반 expected-vs-actual 검증 흐름

---

## 4) 데이터 저장 키(현행)

로컬스토리지 키 목록:

- `ff-intake` : 입력 원본
- `ff-result` : 결과 데이터
- `ff-result-view-mode` : 결과 화면 뷰 모드
- `ff-experience-mode` : 홈/입력 전역 모드
- `ff-hide-onboarding-date` : 온보딩 오늘 숨김
- `ff-hide-onboarding` : 구버전 숨김 키(레거시)
- `ff-adult-verified` : 성인 인증
- `ff-love-state` : 연애 상태
- `ff-total-fortune-reports` : 총운 리포트 배열
- `ff-total-fortune-active-report-id` : 총운 현재 리포트
- `ff-mode-snapshots` : 모드 스냅샷
- `ff-today-secret-score` : 오늘의 비밀 점수
- `ff-ziwei-talisman` : 자미 관련 저장값
- `ff-theme` : 테마 상태

---

## 5) UI/스타일 자산

### 5-1. 공통
- 모바일 우선 폭 제어
- 하단 도크/네비 통일
- 다크 베이스 유지

### 5-2. 웹툰 자산
- 챕터 박스
- 말풍선 스타일
- 컷 단위 reveal 애니메이션
- 웹툰형 원국 테이블 스타일

### 5-3. 리포트 자산
- 카드형 정보 밀집 레이아웃
- 핵심 지표/타임라인/CTA 섹션

---

## 6) 최근 주요 커밋 히스토리 (핵심만)

- `bf0a26e` 모바일 온보딩 "오늘 다시 보지 않기" 날짜기반 수정
- `47ba585` 초기 긴 폼 숨김 + 모드별 입력 서피스/웹툰 스텝 흐름
- `c92b72e` 홈 듀얼 엔트리 게이트 + 전역 모드 상태
- `58c8cfb` 웹툰형 인트로 온보딩 블록
- `e0cf68b` 초기 화면에서 웹툰 결과뷰 선선택 연동
- `d68be6a` 결과 페이지 듀얼뷰(전문가/웹툰)
- `17ade2a` 모바일 기본 폭/레이아웃 강화
- `9c5af8f` 결과 원국 섹션 웹툰 챕터형 리팩터

---

## 7) 알려진 이슈/리빌드 시 주의

1. 페이지별 스타일 톤이 아직 완전 통일되진 않음
2. 온보딩/입력/결과가 기능은 연결되지만, 사용자 체감상 "완전 다른 제품"처럼 보일 수 있음
3. 중첩 `public` 동기화 누락 시 배포 반영 불일치 발생 가능
4. 모바일에서 체크박스/작은 컨트롤 터치 영역 추가 보강 필요

---

## 8) 리빌드(신규 구축) 권장 아키텍처

### 8-1. 정보구조
- `/` : 모드 선택 전용 게이트
- `/onboarding/webtoon` : 웹툰 대화형 입력
- `/onboarding/report` : 정통 바텀시트 입력
- `/result` : 공통 결과 프레임 + 내부 듀얼 렌더러

### 8-2. 상태관리
- 단일 `appState`
  - experienceMode
  - intake
  - result
  - uiPrefs

### 8-3. 렌더링 전략
- 결과는 동일 데이터 소스 하나를 사용
- 렌더러만 분기:
  - `renderReport(result)`
  - `renderWebtoon(result)`

### 8-4. QA 체크 핵심
- 홈→입력→결과 모드 일관성
- 자정 경계(오늘 숨김) 처리
- 성인 게이트 우회 불가
- iOS Safari 입력/스크롤/터치 검증

---

## 9) "유지/폐기/재구축" 권장 분류

### 유지 권장
- 카테고리 체계
- 성인 게이트 로직
- 결과 데이터 스키마(ff-result 기반)
- 총운 리포트 저장 구조

### 축소 권장
- 홈 첫 화면 정보량
- 중복 카피/중복 CTA
- 과도한 스타일 믹스

### 재구축 권장
- 홈 진입 구조(완전 게이트형)
- 입력 UX(웹툰 대화형 vs 정통 바텀시트 완전 분리)
- 결과 상단 요약컷 우선 구조

---

## 10) 최종 결론

지금까지 만든 기능 자산은 충분히 쌓였고, **기능 자체보다 경험 구조를 재조립**하는 단계다.  
즉, 다음 버전은 "기능 추가"보다 **UX 정보구조 재설계 + 톤 통일 + 모드 분기 완성도**에 집중하는 게 가장 효율적이다.

---

## 부록 A) 빠른 점검 링크
- 홈: https://fate-feeling.vercel.app
- 결과: https://fate-feeling.vercel.app/result.html

## 부록 B) 작업 루트
- `/Users/joowon/.openclaw/workspace/fate-feeling`
- 동기화 대상: `/Users/joowon/.openclaw/workspace/fate-feeling/fate-feeling/public`
